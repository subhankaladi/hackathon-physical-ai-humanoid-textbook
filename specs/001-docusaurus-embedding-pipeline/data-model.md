# Data Model: Docusaurus Embedding Pipeline

## Document Chunk Entity

### Definition
Represents a segment of extracted text content with associated metadata for RAG applications.

### Fields
- **id** (string, required)
  - Unique identifier for the chunk
  - Generated as UUID or hash of content + URL
  - Primary key for Qdrant storage

- **content** (string, required)
  - The text content of the chunk
  - Cleaned text extracted from Docusaurus page
  - Maximum recommended size: 1000 characters

- **url** (string, required)
  - Source URL of the content
  - Full URL where the content was extracted from
  - Used for attribution and reference

- **position** (integer, required)
  - Position of chunk in original document
  - Zero-based index indicating order in document
  - Enables reconstruction of document order

- **embedding** (list[float], required)
  - Vector representation of content
  - Generated by Cohere embedding model
  - Dimensions: 1024 (for Cohere multilingual model)

- **created_at** (datetime, required)
  - Timestamp of chunk creation
  - ISO 8601 format
  - Used for tracking and potential TTL

- **metadata** (object, optional)
  - Additional metadata about the chunk
  - May include document title, section, etc.
  - Flexible for future enhancements

### Relationships
- One-to-many relationship with source documents (one document may produce many chunks)

### Validation Rules
- content must be non-empty and less than 2000 characters
- url must be a valid URL format
- embedding must have exactly 1024 dimensions for Cohere model
- position must be non-negative integer

## Qdrant Collection Schema

### Collection Name
- "rag_embedding"

### Vector Configuration
- **Size**: 1024 (matching Cohere embedding dimensions)
- **Distance**: Cosine (optimal for semantic similarity)
- **On Disk**: False (for faster access, can be configured based on needs)

### Payload Schema
```
{
  "content": "string",
  "url": "string",
  "position": "integer",
  "created_at": "string",
  "metadata": "object"
}
```

### Payload Indexes
- Index on "url" field for efficient filtering by source
- Index on "position" field for document reconstruction
- Index on "created_at" field for time-based queries

### Point ID Strategy
- Use UUID4 for point IDs to ensure uniqueness
- Alternative: Hash of content + URL for deterministic IDs

## Process Data Flow

### Input Data
- **Source**: Docusaurus website URL
- **Format**: HTML content from web pages
- **Validation**: Check for valid URL format and accessibility

### Processing Data
- **Raw Text**: Extracted from HTML with cleaning
- **Chunks**: Segmented text based on size and context
- **Embeddings**: Vector representations from Cohere API

### Output Data
- **Vector Points**: Stored in Qdrant with content payload
- **Metadata**: Associated with each vector for retrieval context

## State Transitions

### Chunk Lifecycle
1. **Created**: Text extracted from URL and chunked
2. **Embedded**: Cohere embedding generated
3. **Stored**: Vector saved to Qdrant with metadata
4. **Indexed**: Available for similarity search
5. **Retrieved**: Used in RAG applications (future state)

## Constraints

### Size Constraints
- Individual chunk content: < 2000 characters
- Total embedding vector: exactly 1024 dimensions
- URL length: < 2048 characters (standard limit)

### Performance Constraints
- Embedding generation time: < 2 seconds per chunk
- Qdrant storage time: < 500ms per chunk
- Similarity search time: < 100ms per query

### Data Integrity
- Each chunk must be associated with a valid source URL
- Embeddings must be properly normalized for cosine similarity
- Metadata must be preserved through the pipeline